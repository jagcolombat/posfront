From 08f9a5d944347eaac71bdd1fdddb15ced8d76d69 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Jorge=20Antonio=20G=C3=B3mez=20Colombat?=
 <jorge.gomez@datys.cu>
Date: Sun, 24 Feb 2019 23:10:24 -0500
Subject: [PATCH] fix error on scroll horizontal on grid and grow size of font
 on header

---
 src/app/components/presentationals/ag-grid/ag-grid.component.scss | 4 ++--
 src/app/components/presentationals/ag-grid/ag-grid.component.ts   | 6 ++++--
 src/app/services/bussiness-logic/operations.service.ts            | 1 +
 src/app/services/bussiness-logic/product-order.service.ts         | 5 +++--
 4 files changed, 10 insertions(+), 6 deletions(-)

diff --git a/src/app/components/presentationals/ag-grid/ag-grid.component.scss b/src/app/components/presentationals/ag-grid/ag-grid.component.scss
index 225a375..915ad3e 100644
--- a/src/app/components/presentationals/ag-grid/ag-grid.component.scss
+++ b/src/app/components/presentationals/ag-grid/ag-grid.component.scss
@@ -1,5 +1,5 @@
-ag-grid-angular /deep/ .ag-header-cell-label {
+ag-grid-angular /deep/ .customHeaderLabel {
   /*Necessary to allow for text to grow vertically*/
   width: 100% !important;
-  font-size: 15px !important;
+  font-size: 14px !important;
 }
diff --git a/src/app/components/presentationals/ag-grid/ag-grid.component.ts b/src/app/components/presentationals/ag-grid/ag-grid.component.ts
index 7107c55..f269f3e 100644
--- a/src/app/components/presentationals/ag-grid/ag-grid.component.ts
+++ b/src/app/components/presentationals/ag-grid/ag-grid.component.ts
@@ -3,7 +3,7 @@ import { GridOptions, GridApi } from 'ag-grid-community';
 import { InvoiceService } from "../../../services/bussiness-logic/invoice.service";
 import { ProductOrder } from "../../../models/product-order.model";
 import { Subscription } from "rxjs";
-import {CustomHeaderComponent} from "./custom-header.component";
+import { CustomHeaderComponent } from "./custom-header.component";
 
 @Component({
   selector: 'ag-grid',
@@ -29,6 +29,9 @@ export class AgGridComponent implements OnInit, OnDestroy {
       onRowSelected: (ev) => {
         this.invoiceService.invoiceProductSelected = this.gridOptions.api.getSelectedRows().length > 0;
       },
+      onBodyScroll: (ev) => {
+        this.gridOptions.api.sizeColumnsToFit();
+      },
       rowHeight: 60,
       rowStyle: {'font-size': 'large'}
     };
@@ -48,7 +51,6 @@ export class AgGridComponent implements OnInit, OnDestroy {
       {
         field: 'number_item',
         headerCheckboxSelection: true,
-        headerCheckboxSelectionFilteredOnly: true,
         checkboxSelection: true,
         width: 150,
         headerComponentFramework: CustomHeaderComponent,
diff --git a/src/app/services/bussiness-logic/operations.service.ts b/src/app/services/bussiness-logic/operations.service.ts
index e658de9..ee7e11a 100644
--- a/src/app/services/bussiness-logic/operations.service.ts
+++ b/src/app/services/bussiness-logic/operations.service.ts
@@ -393,6 +393,7 @@ export class OperationsService {
 
   scanProduct(){
     this.invoiceService.addProductByUpc(EOperationType.Scanner).subscribe(prod => {
+      console.log('scanProduct', prod);
       this.invoiceService.evAddProdByUPC.emit(prod);
     }, err => {
       console.error('addProductByUpc', err);
diff --git a/src/app/services/bussiness-logic/product-order.service.ts b/src/app/services/bussiness-logic/product-order.service.ts
index 53b7749..958e0de 100644
--- a/src/app/services/bussiness-logic/product-order.service.ts
+++ b/src/app/services/bussiness-logic/product-order.service.ts
@@ -27,8 +27,9 @@ export class ProductOrderService {
 
   addProduct(product: Product): void {
     if ( product.followDepartment ) {
-      const isAgeVerification = this.departments.find(dpto => dpto.id === product.departmentId).ageVerification;
-      if (isAgeVerification && !this.invoiceService.invoice.clientAge) {
+      const dpto = this.departments.find(dpto => dpto.id === product.departmentId);
+      // const isAgeVerification = this.departments.find(dpto => dpto.id === product.departmentId).ageVerification;
+      if (dpto && dpto.ageVerification && !this.invoiceService.invoice.clientAge) {
         this.ageVerification(product);
       } else {
         this.onCreateProductOrder(product);
-- 
2.9.0.windows.1

